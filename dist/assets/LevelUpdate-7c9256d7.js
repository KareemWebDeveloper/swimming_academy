import{d as L,u as q,r as l,o as B,k as V,l as N,C as A,a as m,c as b,g as t,m as E,f as y,t as F,b as o,w as v,h as w,e as I,s as R}from"./index-54b3e273.js";import{s as U}from"./successMsg-2def3ef6.js";import"./inputswitch.esm-f7379264.js";import{i as $}from"./isEmployeeAuthorizedFor-df272e7f.js";/* empty css                                                   */const z={class:"w-12 md:w-10 m-auto p-2 md:p-5 branches"},K=t("h1",{class:"p-4 text-center textColor"},"انشاء مستوي جديد",-1),M={class:"w-8 m-auto"},P={key:1,class:"px-3 py-2 textColor text-center borderRound error"},D={class:"mt-3"},j=t("div",{class:"flex align-items-center"},[t("label",{for:"levelName",class:"px-3 py-1 text-white text-sm"},"اسم المستوي")],-1),G={class:"mt-3"},H=t("div",{class:"flex align-items-center"},[t("label",{for:"description",class:"px-3 py-1 text-white text-sm"},"وصف المستوي")],-1),J={class:"w-full m-auto repeater"},O={class:"col-12 flex grid w-full mt-3"},Q={class:"flex grid w-full"},ae=L({__name:"LevelUpdate",setup(W){const{push:r,currentRoute:c}=q(),h=parseInt(c.value.params.id),d=l(),f=l(!1),u=l(!1),k=l(!1),T=l(!1),n=l(),i=l(!1),S=a=>{i.value=!0,console.log(a),w.post(`http://127.0.0.1:8000/api/updateLevel/${h}`,a).then(e=>{console.log(e.data),i.value=!1,u.value=!1,f.value=!0,window.scrollTo({top:0,behavior:"smooth"}),k.value?setTimeout(()=>{location.reload()},1600):setTimeout(()=>{r("/levels")},1600)}).catch(e=>{window.scrollTo({top:0,behavior:"smooth"}),i.value=!1,u.value=!0,e.response.data.message.includes("The level name has already been taken")?n.value="هذا المستوي موجود بالفعل":e.response.data.message.includes("The sublevel name has already been taken")?n.value="هناك مستوي الفرعي موجود بالفعل":n.value=e.response.data.message,console.log(e)})},_=()=>{w.get(`http://127.0.0.1:8000/api/level/${h}`).then(a=>{console.log(a.data),d.value=a.data.level,T.value=!0}).catch(a=>{console.log(a)})},x=l(),g=l("admin");return B(()=>{V().then(a=>{a==!1?N().then(e=>{e==!1&&(localStorage.removeItem("SwimmingToken"),location.reload(),r({path:"/login",query:c.value.query})),x.value=e.permissions,g.value="employee",$(x.value,"المستويات",g.value)||(localStorage.removeItem("SwimmingToken"),location.reload(),r({path:"/login",query:c.value.query})),_()}):_()})}),(a,e)=>{const s=A("FormKit");return m(),b("div",z,[K,t("div",M,[f.value?(m(),E(U,{key:0,class:"fadeinright animation-duration-1000 animation-iteration-1"})):y("",!0),u.value?(m(),b("h5",P,F(n.value),1)):y("",!0)]),t("div",null,[o(s,{type:"form",modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=p=>d.value=p),actions:!1,onSubmit:S},{default:v(()=>[t("div",D,[j,o(s,{"prefix-icon":"text",id:"levelName",type:"text",label:"اسم المستوي",placeholder:"أدخل اسم المستوي",name:"level_name",validation:"required|length:3"})]),t("div",G,[H,o(s,{"prefix-icon":"tools",id:"description",type:"textarea",label:"وصف المستوي",placeholder:"أدخل وصف المستوي",name:"level_description",validation:"length:3"})]),t("div",J,[o(s,{id:"repeater",name:"sublevels",type:"repeater",label:"المستوىات الفرعية","add-label":"اضافة مستوي فرعي"},{default:v(({index:p})=>[o(s,{type:"text","prefix-icon":"text",name:"sublevel_name",label:`${p+1}. اسم المستوي الفرعي`,placeholder:"أدخل اسم المستوي",validation:"required|length:3"},null,8,["label"]),t("div",O,[o(s,{id:"repeater",name:"checkpoints",type:"repeater","add-label":"اضافة مهارة",label:"مهارات المستوي"},{default:v(({index:C})=>[t("div",Q,[o(s,{type:"text",name:"checkpoint_name","outer-class":"col-12",label:`${C+1}. المهارة`,placeholder:"أدخل المهارة المكتسبة","prefix-icon":"text",validation:"required|length:3"},null,8,["label"]),o(s,{type:"textarea",name:"checkpoint_description","outer-class":"col-12",label:"وصف المهارة",placeholder:"أدخل وصف المهارة","prefix-icon":"tools",validation:""})])]),_:2},1024)])]),_:1})]),o(I(R),{type:"submit",class:"submitBtn",label:"انشاء",loading:i.value},null,8,["loading"])]),_:1},8,["modelValue"])])])}}});export{ae as default};

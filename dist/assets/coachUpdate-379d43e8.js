import{d as D,u as U,r as s,o as j,k as P,l as R,C as $,a as m,c as g,b as l,w as y,e as b,g as e,m as M,f as w,t as h,F as N,h as C,s as V,v as K}from"./index-54b3e273.js";import{s as H}from"./successMsg-2def3ef6.js";import"./inputswitch.esm-f7379264.js";import{i as L}from"./isEmployeeAuthorizedFor-df272e7f.js";/* empty css                                                   */const G={class:"flex align-items-center justify-content-center"},J={class:"flex align-items-center mx-5 justify-content-center flex-column"},O=e("div",{class:"flex align-items-center my-2"},[e("span",{class:"material-symbols-outlined mx-1 text-2xl"}," tag "),e("h4",null,"الكود")],-1),Q={class:"flex align-items-center mx-5 justify-content-center flex-column"},W=e("div",{class:"flex align-items-center my-2"},[e("h4",null,"الاسم"),e("span",{class:"material-symbols-outlined text-2xl"}," scuba_diving ")],-1),X={class:"flex align-items-center mx-5 justify-content-center flex-column"},Y=e("div",{class:"flex align-items-center my-2"},[e("span",{class:"material-symbols-outlined mx-1 text-2xl"}," monetization_on "),e("h4",null,"الراتب")],-1),Z={class:"w-12 md:w-10 m-auto p-2 md:p-5 branches"},ee=e("h1",{class:"p-4 text-center textColor"},"تسجيل مدرب جديد",-1),ae={class:"w-8 m-auto"},te={key:1,class:"px-3 py-2 textColor text-center borderRound error"},se={key:0},le={class:"flex grid w-full"},oe={class:"mt-3 col-12"},ne=e("div",{class:"flex align-items-center"},[e("label",{for:"name",class:"px-3 py-1 text-white text-sm"},"اسم المدرب")],-1),ie={class:"mt-3 col-12 md:col-6"},ce=e("div",{class:"flex align-items-center"},[e("label",{for:"mail",class:"px-3 py-1 text-white text-sm"},"البريد الالكتروني")],-1),re={class:"mt-3 col-12 md:col-6"},de=e("div",{class:"flex align-items-center"},[e("label",{for:"phone",class:"px-3 py-1 text-white text-sm"},"رقم الهاتف")],-1),ue={class:"col-12 md:col-6"},me=e("div",{class:"flex align-items-center"},[e("label",{for:"Pw",class:"px-3 py-1 text-white text-sm"},"كلمة السر")],-1),he={class:"col-12 md:col-6"},pe=e("div",{class:"flex align-items-center"},[e("label",{for:"salary_per_hour",class:"px-3 py-1 text-white text-sm"},"الراتب في الساعة")],-1),ve={class:"col-12"},fe=e("div",{class:"flex align-items-center"},[e("label",{for:"address",class:"px-3 py-1 text-white text-sm"},"عنوان المدرب")],-1),_e={class:"col-12"},xe=e("div",{class:"flex align-items-center"},[e("label",{for:"address",class:"px-3 py-1 text-white text-sm"},"الفروع التي يعمل بها")],-1),qe=D({__name:"coachUpdate",setup(ge){const{push:p,currentRoute:v}=U(),k=parseInt(v.value.params.id),n=s(),q=s([]),f=s(!1),_=s(!1),E=s(!1),T=s(!1),B=s(!1),i=s(),c=s(!1),r=s(),d=s(!1),z=t=>{c.value=!0,console.log(t),C.put(`http://127.0.0.1:8000/api/updateCoach/${k}`,t).then(a=>{r.value=a.data.coach,c.value=!1,_.value=!1,f.value=!0,window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{d.value=!0,f.value=!1},1400)}).catch(a=>{window.scrollTo({top:0,behavior:"smooth"}),c.value=!1,_.value=!0,a.response.data.message.includes("The phone has already been taken")?i.value="هذا الهاتف موجود بالفعل":a.response.data.message.includes("The email has already been taken")?i.value="هذا البريد الالكتروني موجود بالفعل":i.value=a.response.data.message,console.log(a)})},F=()=>{C.get(`http://127.0.0.1:8000/api/coach/${k}`).then(t=>{n.value=t.data.coach,n.value.password="",n.value.branchIds=[],t.data.coach.branches.forEach(a=>{n.value.branchIds.push(a.id)}),console.log(n.value),B.value=!0}).catch(t=>{console.log(t)})},S=()=>{C.get("http://127.0.0.1:8000/api/branches").then(t=>{console.log(t.data),t.data.branches.forEach(a=>{q.value.push({label:a.branch_name,value:a.id})}),T.value=!0}).catch(t=>{console.log(t)})},A=()=>{E.value||p("/coaches")},x=s(),I=s("admin");return j(()=>{P().then(t=>{t==!1?R().then(a=>{a==!1&&(localStorage.removeItem("SwimmingToken"),location.reload(),console.log("not employee"),p({path:"/login",query:v.value.query})),x.value=a.permissions,I.value="employee",L(x.value,"تسجيل و تعديل المدربين",I.value)||(localStorage.removeItem("SwimmingToken"),console.log("not authorized"),location.reload(),p({path:"/login",query:v.value.query})),console.log(x.value),F(),S()}):(F(),S())})}),(t,a)=>{const o=$("FormKit");return m(),g(N,null,[l(b(K),{visible:d.value,"onUpdate:visible":a[1]||(a[1]=u=>d.value=u),onAfterHide:A,modal:"",header:"بيانات المدرب",style:{width:"50vw"}},{footer:y(()=>[l(b(V),{label:"تم",class:"px-4 py-1",onClick:a[0]||(a[0]=u=>d.value=!1),autofocus:""})]),default:y(()=>[e("div",G,[e("div",J,[O,e("p",null,h(r.value.id),1)]),e("div",Q,[W,e("p",null,"كابتن / "+h(r.value.name),1)]),e("div",X,[Y,e("p",null,h(r.value.salary_per_hour.toFixed(2))+" ج.م / ساعة",1)])])]),_:1},8,["visible"]),e("div",Z,[ee,e("div",ae,[f.value?(m(),M(H,{key:0,class:"fadeinright animation-duration-1000 animation-iteration-1"})):w("",!0),_.value?(m(),g("h5",te,h(i.value),1)):w("",!0)]),T.value&&B.value?(m(),g("div",se,[l(o,{type:"form",actions:!1,modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=u=>n.value=u),onSubmit:z},{default:y(()=>[e("div",le,[e("div",oe,[ne,l(o,{"prefix-icon":"avatarMan",id:"name",type:"text",label:"اسم المدرب",placeholder:"أدخل اسم المدرب",name:"name",validation:"required|length:2"})]),e("div",ie,[ce,l(o,{"prefix-icon":"email",id:"mail",type:"email",label:"البريد الالكتروني",placeholder:"أدخل البريد الالكتروني",name:"email",validation:"required|email"})]),e("div",re,[de,l(o,{"prefix-icon":"telephone",id:"phone",type:"text",label:"اسم المدرب",placeholder:"أدخل رقم هاتف المدرب",name:"phone",validation:"required|length:10"})]),e("div",ue,[me,l(o,{"prefix-icon":"password",id:"Pw",type:"password",label:"كلمة السر",placeholder:"أدخل كلمة السر للمدرب",name:"password",validation:"required|length:8"})]),e("div",he,[pe,l(o,{"prefix-icon":"dollar",id:"salary_per_hour",type:"text",label:"الراتب",placeholder:"أدخل الراتب في الساعة للمدرب ",number:"float",name:"salary_per_hour",validation:"required|min:1"})]),e("div",ve,[fe,l(o,{"prefix-icon":"text",id:"address",type:"textarea",label:"العنوان",placeholder:"أدخل عنوان للمدرب ",name:"address",validation:"required|length:3"})]),e("div",_e,[xe,l(o,{type:"dropdown",name:"branchIds",label:"الفروع",placeholder:"اختر الفروع التي يعمل بها المدرب",options:q.value,multiple:""},null,8,["options"])])]),l(b(V),{type:"submit",class:"submitBtn",label:"حفظ",loading:c.value},null,8,["loading"])]),_:1},8,["modelValue"])])):w("",!0)])],64)}}});export{qe as default};

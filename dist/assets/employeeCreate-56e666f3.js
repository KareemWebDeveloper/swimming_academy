import{d as A,u as z,r as l,o as I,k as P,l as D,C as M,a as m,c as _,b as a,w as y,e as u,g as e,m as N,f as g,t as p,F as U,h as b,s as R,v as $}from"./index-54b3e273.js";import{s as K}from"./successMsg-2def3ef6.js";import{s as H}from"./inputswitch.esm-f7379264.js";import{i as L}from"./isEmployeeAuthorizedFor-df272e7f.js";/* empty css                                                   */const G={class:"flex align-items-center justify-content-center"},J={class:"flex align-items-center mx-5 justify-content-center flex-column"},O=e("div",{class:"flex align-items-center my-2"},[e("span",{class:"material-symbols-outlined mx-1 text-2xl"}," tag "),e("h4",null,"الكود")],-1),Q={class:"flex align-items-center mx-5 justify-content-center flex-column"},W=e("div",{class:"flex align-items-center my-2"},[e("h4",null,"الاسم"),e("span",{class:"material-symbols-outlined text-2xl"}," scuba_diving ")],-1),X={class:"flex align-items-center mx-5 justify-content-center flex-column"},Y=e("div",{class:"flex align-items-center my-2"},[e("span",{class:"material-symbols-outlined mx-1 text-2xl"}," monetization_on "),e("h4",null,"الراتب")],-1),Z={class:"w-12 md:w-10 m-auto p-2 md:p-5 branches"},ee=e("h1",{class:"p-4 text-center textColor"},"تسجيل موظف جديد",-1),te={class:"w-8 m-auto"},se={key:1,class:"px-3 py-2 textColor text-center borderRound error"},le={key:0},ae={class:"flex grid w-full"},oe={class:"mt-3 col-12"},ie=e("div",{class:"flex align-items-center"},[e("label",{for:"name",class:"px-3 py-1 text-white text-sm"},"اسم الموظف")],-1),ne={class:"mt-3 col-12 md:col-6"},ce=e("div",{class:"flex align-items-center"},[e("label",{for:"mail",class:"px-3 py-1 text-white text-sm"},"البريد الالكتروني")],-1),re={class:"mt-3 col-12 md:col-6"},de=e("div",{class:"flex align-items-center"},[e("label",{for:"phone",class:"px-3 py-1 text-white text-sm"},"رقم الهاتف")],-1),me={class:"col-12 md:col-6"},ue=e("div",{class:"flex align-items-center"},[e("label",{for:"Pw",class:"px-3 py-1 text-white text-sm"},"كلمة السر")],-1),pe={class:"col-12 md:col-6"},he=e("div",{class:"flex align-items-center"},[e("label",{for:"salary_per_hour",class:"px-3 py-1 text-white text-sm"},"الراتب في الشهر")],-1),ve={class:"col-12"},fe=e("div",{class:"flex align-items-center"},[e("label",{for:"address",class:"px-3 py-1 text-white text-sm"},"عنوان الموظف")],-1),xe={class:"col-12"},_e=e("div",{class:"flex align-items-center"},[e("label",{for:"address",class:"px-3 py-1 text-white text-sm"},"الفروع التي يعمل بها")],-1),ye={class:"col-12"},ge=e("div",{class:"flex align-items-center"},[e("label",{for:"address",class:"px-3 py-1 text-white text-sm"},"الأدوار المتاحة")],-1),be={class:"flex justify-content-center align-items-center my-3"},we=e("h4",{class:"text-sm mx-2 textColor"},"ابق في نفس الصفحة",-1),Fe=A({__name:"employeeCreate",setup(ke){const{push:h,currentRoute:w}=z(),k=l([]),C=l([]),v=l(!1),f=l(!1),x=l(!1),T=l(!1),E=l(!1),i=l(),n=l(!1),c=l(),r=l(!1),V=s=>{n.value=!0,console.log(s),b.post("http://127.0.0.1:8000/api/createEmployee",s).then(t=>{c.value=t.data.employee,n.value=!1,f.value=!1,v.value=!0,window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{r.value=!0,v.value=!1},1400)}).catch(t=>{window.scrollTo({top:0,behavior:"smooth"}),n.value=!1,f.value=!0,t.response.data.message.includes("The phone has already been taken")?i.value="هذا الهاتف موجود بالفعل":t.response.data.message.includes("The email has already been taken")?i.value="هذا البريد الالكتروني موجود بالفعل":i.value=t.response.data.message,console.log(t)})},q=()=>{b.get("http://127.0.0.1:8000/api/branches").then(s=>{console.log(s.data),s.data.branches.forEach(t=>{k.value.push({label:t.branch_name,value:t.id})}),T.value=!0}).catch(s=>{console.log(s)})},B=()=>{b.get("http://127.0.0.1:8000/api/roles").then(s=>{console.log(s.data),s.data.roles.forEach(t=>{C.value.push({label:t.role_name,value:t.id})}),E.value=!0}).catch(s=>{console.log(s)})},j=()=>{x.value?setTimeout(()=>{location.reload()},300):h("/employees")},F=l(),S=l("admin");return I(()=>{P().then(s=>{s==!1?D().then(t=>{t==!1&&(localStorage.removeItem("SwimmingToken"),location.reload(),h({path:"/login",query:w.value.query})),F.value=t.permissions,S.value="employee",L(F.value,"تسجيل و تعديل الموظفين",S.value)||(localStorage.removeItem("SwimmingToken"),location.reload(),h({path:"/login",query:w.value.query})),q(),B()}):(q(),B())})}),(s,t)=>{const o=M("FormKit");return m(),_(U,null,[a(u($),{visible:r.value,"onUpdate:visible":t[1]||(t[1]=d=>r.value=d),onAfterHide:j,modal:"",header:"بيانات الموظف",style:{width:"50vw"}},{footer:y(()=>[a(u(R),{label:"تم",class:"px-4 py-1",onClick:t[0]||(t[0]=d=>r.value=!1),autofocus:""})]),default:y(()=>[e("div",G,[e("div",J,[O,e("p",null,p(c.value.id),1)]),e("div",Q,[W,e("p",null,p(c.value.name),1)]),e("div",X,[Y,e("p",null,p(c.value.salary.toFixed(2))+" ج.م / شهر",1)])])]),_:1},8,["visible"]),e("div",Z,[ee,e("div",te,[v.value?(m(),N(K,{key:0,class:"fadeinright animation-duration-1000 animation-iteration-1"})):g("",!0),f.value?(m(),_("h5",se,p(i.value),1)):g("",!0)]),T.value&&E.value?(m(),_("div",le,[a(o,{type:"form",actions:!1,onSubmit:V},{default:y(()=>[e("div",ae,[e("div",oe,[ie,a(o,{"prefix-icon":"avatarMan",id:"name",type:"text",label:"اسم الموظف",placeholder:"أدخل اسم الموظف",name:"name",validation:"required|length:2"})]),e("div",ne,[ce,a(o,{"prefix-icon":"email",id:"mail",type:"email",label:"البريد الالكتروني",placeholder:"أدخل البريد الالكتروني",name:"email",validation:"email"})]),e("div",re,[de,a(o,{"prefix-icon":"telephone",id:"phone",type:"text",label:"اسم الموظف",placeholder:"أدخل رقم هاتف الموظف",name:"phone",validation:"required|length:10"})]),e("div",me,[ue,a(o,{"prefix-icon":"password",id:"Pw",type:"password",label:"كلمة السر",placeholder:"أدخل كلمة السر للموظف",name:"password",validation:"required|length:8"})]),e("div",pe,[he,a(o,{"prefix-icon":"dollar",id:"salary",type:"text",label:"الراتب",placeholder:"أدخل الراتب للموظف ",number:"float",name:"salary",validation:"required|min:0"})]),e("div",ve,[fe,a(o,{"prefix-icon":"text",id:"address",type:"textarea",label:"العنوان",placeholder:"أدخل عنوان للموظف ",name:"address",validation:"required|length:3"})]),e("div",xe,[_e,a(o,{type:"dropdown",name:"branchIds",label:"الفروع",placeholder:"اختر الفروع التي يعمل بها الموظف",options:k.value,multiple:""},null,8,["options"])]),e("div",ye,[ge,a(o,{type:"dropdown",name:"roleIds",label:"الأدوار",placeholder:"اختر الأدوار التي سيقوم بها الموظف",options:C.value,multiple:""},null,8,["options"])])]),e("div",be,[a(u(H),{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=d=>x.value=d)},null,8,["modelValue"]),we]),a(u(R),{type:"submit",class:"submitBtn",label:"تسجيل",loading:n.value},null,8,["loading"])]),_:1})])):g("",!0)])],64)}}});export{Fe as default};

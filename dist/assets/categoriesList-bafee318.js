import{d as Z,u as G,j as J,r as o,o as X,k as Y,l as ee,C as te,a as c,c as x,b as l,w as i,e as t,g as r,m as k,f as d,F as ae,h as M,p as w,t as N,s as C,v as oe,x as le,y as se,n as ie,z as $,A as L}from"./index-5ed95cfa.js";import{a as re,s as ne}from"./inlinemessage.esm-b859ab3c.js";import{s as g}from"./column.esm-6404a039.js";import{s as U}from"./successMsg-575c06f8.js";import{i as S}from"./isEmployeeAuthorizedFor-df272e7f.js";import"./index.esm-93947ef4.js";/* empty css                                                   */const ue={key:1,class:"px-3 py-2 textColor text-center borderRound error"},ce={class:"mt-3"},de=r("div",{class:"flex align-items-center"},[r("label",{for:"categoryName",class:"px-3 py-1 text-white text-sm"},"نوع التمرينة")],-1),me={class:"w-12 md:w-10 my-5 m-auto p-2 md:p-5 branchesList",style:{direction:"rtl"}},pe={class:"w-full m-auto flex justify-content-center p-4 MargAutoMob padding-1-breadcrumbs",style:{direction:"ltr"}},ve={key:1},ge={class:"flex flex-column lg:flex-row justify-content-between align-items-center"},fe={class:"flex align-items-center"},ye=r("h3",{class:"hidden md:my-2 lg:my-0 md:flex"},"أنواع التمارين",-1),he={class:"p-input-icon-left"},be=r("i",{class:"pi pi-search"},null,-1),_e={key:0,class:"flex align-items-center"},xe=["onClick"],ke=["onClick"],Me=Z({__name:"categoriesList",setup(we){const{push:T,currentRoute:R}=G(),j=J(),q=o(!1),f=o(!1),V=o(!1),A=o(!1),F=o(!1),y=o(!1),h=o(),n=o([]),D=o(!1),B=o([]);B.value=[{label:"أنواع التمارين",route:"/categories",to:"/categories"},{label:"عرض الأنواع",route:"/categories",to:"/categories"}];const z=o({icon:"pi pi-home",to:"/"}),K=s=>{j.require({target:s.currentTarget,message:"هل متأكد أنك تريد حذف هذا النوع ؟",icon:"pi pi-exclamation-triangle",acceptLabel:"نعم",rejectLabel:"لا",accept:()=>{Q()},reject:()=>{}})},m=o(),b=o({global:{value:null,matchMode:$.CONTAINS},category_name:{operator:L.AND,constraints:[{value:null,matchMode:$.STARTS_WITH}]},id:{operator:L.AND,constraints:[{value:null,matchMode:$.EQUALS}]}}),O={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"Africa/Cairo",locale:"ar"},H=new Intl.DateTimeFormat("ar",O),_=()=>{M.get("https://akademia.website/api/categories").then(s=>{console.log(s.data),m.value=s.data.categories,m.value.forEach(e=>{e.created_at=new Date(e.created_at)}),q.value=!0}).catch(s=>{console.log(s)})},P=s=>{y.value=!0,M.put(`https://akademia.website/api/updateCategory/${h.value.id}`,s).then(e=>{console.log(e.data),y.value=!1,F.value=!0,V.value=!1,setTimeout(()=>{f.value=!1,F.value=!1},1500)}).catch(e=>{y.value=!1,V.value=!0,e.response.data.message.includes("The category name has already been taken")?A.value="هذا النوع موجود بالفعل":A.value=e.response.data.message,console.log(e)})},Q=()=>{console.log(n.value);let s=[];n.value.forEach(u=>{s.push(u.id)});let e={category_ids:s};M.post("https://akademia.website/api/categoryBulkDelete",e).then(u=>{console.log(u),D.value=!0,n.value=[],_(),setTimeout(()=>{D.value=!1},4500)}).catch(u=>{n.value=[],console.log(u)})},p=o(),v=o("admin");X(()=>{Y().then(s=>{s==!1?ee().then(e=>{e==!1&&(localStorage.removeItem("SwimmingToken"),location.reload(),T({path:"/login",query:R.value.query})),p.value=e.permissions,v.value="employee",S(p.value,"عرض أنواع التمارين",v.value)||(localStorage.removeItem("SwimmingToken"),location.reload(),T({path:"/login",query:R.value.query})),console.log(p.value),_()}):_()})});const E=o(),W=()=>{E.value.exportCSV()};return(s,e)=>{const u=te("FormKit");return c(),x(ae,null,[l(t(oe),{visible:f.value,"onUpdate:visible":e[1]||(e[1]=a=>f.value=a),onAfterHide:_,maximizable:"",modal:"",header:"تعديل النوع",style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"}},{footer:i(()=>[]),default:i(()=>[l(u,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=a=>h.value=a),type:"form",actions:!1,onSubmit:P},{default:i(()=>[F.value?(c(),k(U,{key:0,class:"fadeinright animation-duration-500 animation-iteration-1 my-4"},{default:i(()=>[w("تم التعديل بنجاح")]),_:1})):d("",!0),V.value?(c(),x("h5",ue,N(A.value),1)):d("",!0),r("div",ce,[de,l(u,{"prefix-icon":"text",id:"categoryName",type:"text",label:"نوع التمرين",placeholder:"أدخل نوع تمرين جديد",name:"category_name",validation:"required|length:3"})]),l(t(C),{type:"submit",class:"submitBtn",label:"انشاء",loading:y.value},null,8,["loading"])]),_:1},8,["modelValue"])]),_:1},8,["visible"]),r("div",me,[r("div",pe,[l(t(le),{home:z.value,model:B.value},null,8,["home","model"])]),l(t(se)),D.value?(c(),k(U,{key:0,class:"fadeinright animation-duration-500 animation-iteration-1 my-4"},{default:i(()=>[w("تم الحذف بنجاح")]),_:1})):d("",!0),q.value&&m.value.length>=0?(c(),x("div",ve,[l(t(ne),{filters:b.value,"onUpdate:filters":e[5]||(e[5]=a=>b.value=a),ref_key:"dt",ref:E,stripedRows:"",value:m.value,selection:n.value,"onUpdate:selection":e[6]||(e[6]=a=>n.value=a),stateStorage:"session",stateKey:"categories-state-session",paginator:"",rows:10,rowsPerPageOptions:[10,20,50],filterDisplay:"menu",dataKey:"id",removableSort:"",globalFilterFields:["id","category_name"],tableStyle:"min-width: 50rem"},{header:i(()=>[r("div",ge,[r("div",fe,[t(S)(p.value,"انشاء و تعديل أنواع التمارين",v.value)?(c(),k(t(C),{key:0,type:"button",class:"mb-3 lg:mb-0 mx-2",onClick:e[2]||(e[2]=a=>t(T)("/category/create")),label:"انشاء نوع"})):d("",!0),t(S)(p.value,"انشاء و تعديل أنواع التمارين",v.value)?(c(),k(t(C),{key:1,type:"button",disabled:n.value.length==0,severity:"danger",class:"mb-3 lg:mb-0 mx-2",label:"حذف المحدد"},null,8,["disabled"])):d("",!0)]),ye,r("span",he,[be,l(t(ie),{modelValue:b.value.global.value,"onUpdate:modelValue":e[3]||(e[3]=a=>b.value.global.value=a),placeholder:"بحث شامل"},null,8,["modelValue"])])])]),empty:i(()=>[l(t(re),{severity:"info"},{default:i(()=>[w("لا يوجد أنواع")]),_:1})]),paginatorend:i(()=>[l(t(C),{type:"button",icon:"pi pi-download",onClick:e[4]||(e[4]=a=>W(a)),text:""})]),footer:i(()=>[w(" في المجموع هناك "+N(m.value?m.value.length:0)+" أنواع ",1)]),default:i(()=>[l(t(g),{selectionMode:"multiple",headerStyle:"width: 3rem"}),l(t(g),{field:"id",sortable:"",header:"الكود"}),l(t(g),{field:"category_name",sortable:"",header:"النوع"}),l(t(g),{field:"created_at",sortable:"",header:"تاريخ الانشاء",style:{width:"36%"}},{body:i(a=>[r("p",null,N(t(H).format(a.data.created_at)),1)]),_:1}),l(t(g),{header:"تعديل",style:{width:"14%"}},{body:i(a=>[t(S)(p.value,"انشاء و تعديل أنواع التمارين",v.value)?(c(),x("div",_e,[r("span",{class:"material-symbols-outlined cursor-pointer hoverIcon textColor text-3xl p-2 borderRound",onClick:I=>{n.value=[{id:a.data.id}],K(I)}}," delete_forever ",8,xe),r("span",{onClick:I=>{h.value=a.data,f.value=!0},class:"material-symbols-outlined cursor-pointer hoverIcon mx-2 textColor text-3xl p-2 borderRound"}," edit ",8,ke)])):d("",!0)]),_:1})]),_:1},8,["filters","value","selection"])])):d("",!0)])],64)}}});export{Me as default};

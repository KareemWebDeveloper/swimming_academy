import{d as $,u as L,j as V,r as s,o as P,k as z,l as O,C as U,a as _,c as v,g as e,b as l,e as c,w as K,t as m,f as W,h as f,x as G,y as H,s as g,ab as Q,z as h,A as b}from"./index-54b3e273.js";import"./inlinemessage.esm-9b16a9f3.js";/* empty css                                                   */import"./calendar.esm-ee3de14d.js";import{i as q}from"./isEmployeeAuthorizedFor-df272e7f.js";import"./index.esm-8fb1d516.js";const J={class:"w-12 md:w-10 my-5 m-auto p-2 md:p-5 branchesList",style:{direction:"rtl"}},X={class:"w-full m-auto flex justify-content-center p-4 MargAutoMob padding-1-breadcrumbs",style:{direction:"ltr"}},Y={key:0},Z=e("h2",{class:"text-center my-5 text-white"},"انشاء تقرير الأرباح",-1),ee={class:"mt-3"},te=e("div",{class:"flex align-items-center"},[e("label",{for:"branch",class:"px-3 py-1 text-white text-sm"},"الفرع")],-1),ae={class:"mt-3"},se=e("div",{class:"flex align-items-center"},[e("label",{for:"start_date",class:"px-3 py-1 text-white text-sm"},"الأرباح منذ")],-1),oe={class:"mt-3"},le=e("div",{class:"flex align-items-center"},[e("label",{for:"end_date",class:"px-3 py-1 text-white text-sm"},"الأرباح حتي")],-1),ne={key:1,class:"m-auto"},ie={class:"text-center m-auto"},ce=e("span",{style:{color:"rgba(3, 203, 0, 0.565)"},class:"material-symbols-outlined text-7xl text-center m-auto"}," table_chart_view ",-1),re={class:"textColor my-3"},de={class:"flex justify-content-center textColor align-items-center p-5 m-auto"},ue={class:"flex align-items-center w-full"},me={class:"bg-card borderRound p-3 m-auto w-6"},_e={style:{"background-color":"rgba(3, 203, 0, 0.265)"},class:"flex my-3 p-3 borderRound lg:my-1 align-items-center mx-3 justify-content-center flex-column"},ve=e("div",{class:"flex align-items-center my-2"},[e("h3",{class:"text-white"},"اجمالي الايرادات"),e("span",{class:"material-symbols-outlined text-white mx-1 text-4xl"}," trending_up ")],-1),he={class:""},pe={class:"flex align-items-center justify-content-center"},xe={class:"textColor font-bold text-xl my-2",style:{color:"#04CB00"}},fe=e("span",{class:"material-symbols-outlined mx-1 text-4xl",style:{color:"#04CB00"}}," call_made ",-1),ge={class:"flex align-items-center justify-content-center"},be={class:"bg-card borderRound p-3 m-auto w-6 mx-2"},ye={style:{"background-color":"#ff000028"},class:"flex my-3 p-3 borderRound lg:my-1 align-items-center mx-3 justify-content-center flex-column"},we=e("div",{class:"flex align-items-center my-2"},[e("h3",{class:"text-white"},"اجمالي المصروفات"),e("span",{class:"material-symbols-outlined text-white mx-1 text-4xl"}," trending_down ")],-1),Ce={class:""},Fe={class:"flex align-items-center justify-content-center"},ke={class:"textColor font-bold text-xl my-2",style:{color:"#FF0000"}},Be=e("span",{class:"material-symbols-outlined mx-1 text-4xl",style:{color:"#FF0000"}}," call_received ",-1),Ee={class:"flex align-items-center justify-content-center"},De={key:0,class:"my-5"},Se=e("div",{class:"flex m-auto align-items-center justify-content-center"},[e("h2",{class:"textColor text-center"},"اجمالي الأرباح"),e("span",{class:"mx-2 text-6xl material-symbols-outlined textColor"}," moving ")],-1),Ae={class:"textColor text-center my-3",style:{color:"#04CB00"}},Re={key:1,class:"my-5"},Te=e("div",{class:"flex m-auto align-items-center justify-content-center"},[e("h2",{class:"textColor text-center"},"اجمالي الخسارة"),e("span",{class:"mx-2 text-6xl material-symbols-outlined textColor"}," trending_down ")],-1),je={class:"textColor text-center my-3",style:{color:"#ff0000da"}},Ne={class:"bg-card p-3 borderRound"},Oe=$({__name:"Profits",setup(Ie){const{push:p,currentRoute:y}=L();V();const w=s(!1),x=s(!1),C=s(!1),n=s(0),i=s(0),r=s(!0),u=s(),F=s();s([]),s(0);const k=s(),T=s(),B=s([]);B.value=[{label:"تقرير الأرباح",route:"/profits",to:"/profits"}];const j=s({icon:"pi pi-home",to:"/"});s({global:{value:null,matchMode:h.CONTAINS},academy_name:{operator:b.AND,constraints:[{value:null,matchMode:h.STARTS_WITH}]},paid_date:{operator:b.AND,constraints:[{value:null,matchMode:h.DATE_AFTER},{value:null,matchMode:h.DATE_BEFORE}]},id:{operator:b.AND,constraints:[{value:null,matchMode:h.EQUALS}]}});const N=a=>{a.start_date=new Date(a.start_date).toLocaleDateString(),a.end_date=new Date(a.end_date).toLocaleDateString(),f.post(`http://127.0.0.1:8000/api/expensesInInterval/${a.branch_id}`,a).then(t=>{console.log(t.data),t.data.variableExpenses.forEach(o=>{i.value+=o.expense_cost}),t.data.constantExpenses.forEach(o=>{i.value+=o.expense_cost}),t.data.salaries&&t.data.salaries.forEach(o=>{i.value+=o.amount}),k.value={labels:["الايرادات","المصروفات"],datasets:[{label:["الايرادات","المصروفات"],data:[n.value,i.value],backgroundColor:["rgba(3, 203, 0, 0.31)","#ff000054"],borderColor:["rgba(3, 203, 0, 0.81)","#ff000094"],borderWidth:2}]},w.value=!0}).catch(t=>{console.log(t)})},I=a=>{f.post(`http://127.0.0.1:8000/api/revenuesInInterval/${a.branch_id}`,a).then(t=>{console.log(t.data),t.data.subscriptions.forEach(o=>{if(o.sale){let d=parseFloat(o.price)-parseFloat(o.sale);n.value+=d}else n.value+=parseFloat(o.price)}),t.data.installments.forEach(o=>{n.value+=parseFloat(o.amount)}),N(a),x.value=!1,r.value=!1}).catch(t=>{console.log(t)})},E=s([{label:"كل الفروع",value:0}]);s([]);const D=[],S=()=>{f.get("http://127.0.0.1:8000/api/branches").then(a=>{console.log(a.data),a.data.branches.forEach(t=>{E.value.push({label:t.branch_name,value:t.id}),D.push({label:t.branch_name,value:t.id})}),C.value=!0}).catch(a=>{console.log(a)})},M=a=>{if(x.value=!0,I(a),a.branch_id==0)F.value="تقرير أرباح كل الفروع";else{let t=D.filter(o=>o.value==a.branch_id);t=t[0].label,F.value=`تقرير أرباح فرع ${t}`}};s();const A=s(),R=s("admin");return P(()=>{z().then(a=>{a==!1?O().then(t=>{t==!1&&(localStorage.removeItem("SwimmingToken"),location.reload(),p({path:"/login",query:y.value.query})),A.value=t.permissions,R.value="employee",q(A.value,"الحسابات المالية",R.value)||(localStorage.removeItem("SwimmingToken"),location.reload(),p({path:"/login",query:y.value.query})),S()}):S()})}),(a,t)=>{const o=U("FormKit");return _(),v("div",J,[e("div",X,[l(c(G),{home:j.value,model:B.value},null,8,["home","model"])]),l(c(H)),r.value&&C.value?(_(),v("div",Y,[Z,l(o,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=d=>u.value=d),type:"form",actions:!1,onSubmit:M},{default:K(()=>[e("div",ee,[te,l(o,{type:"dropdown",id:"branch",validation:"required",name:"branch_id",label:"الفرع",placeholder:"اختر الفرع الذي تريد تقرير عنه",options:E.value},null,8,["options"])]),e("div",ae,[se,l(o,{type:"datepicker",name:"start_date",label:"الأرباح منذ",id:"start_date",format:{date:"short"},validation:"required",value:new Date},null,8,["value"])]),e("div",oe,[le,l(o,{type:"datepicker",name:"end_date",label:"الأرباح حتي",id:"end_date",format:{date:"short"},validation:"required",value:new Date},null,8,["value"])]),l(c(g),{type:"submit",class:"submitBtn",label:"التالي",loading:x.value},null,8,["loading"])]),_:1},8,["modelValue"])])):w.value&&!r.value?(_(),v("div",ne,[e("div",ie,[ce,e("h3",re,"منذ "+m(new Date(u.value.start_date).toLocaleDateString())+" إلي "+m(new Date(u.value.end_date).toLocaleDateString()),1)]),e("div",de,[e("h4",{class:"cursor-pointer",onClick:t[1]||(t[1]=d=>r.value=!r.value)},"رجوع"),e("span",{class:"material-symbols-outlined cursor-pointer mx-2 text-5xl",onClick:t[2]||(t[2]=d=>r.value=!r.value)}," arrow_back ")]),e("div",ue,[e("div",me,[e("div",_e,[ve,e("div",he,[e("div",pe,[e("p",xe,"ج.م "+m(n.value.toFixed(2)),1),fe])])]),e("div",ge,[l(c(g),{label:"تفاصيل الايرادات",onClick:t[3]||(t[3]=d=>c(p)({path:"/revenues",query:{branchId:u.value.branch_id}})),class:"px-4 my-2 profitBg"})])]),e("div",be,[e("div",ye,[we,e("div",Ce,[e("div",Fe,[e("p",ke," ج.م "+m(i.value.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),1),Be])])]),e("div",Ee,[l(c(g),{label:"تفاصيل المصروفات",onClick:t[4]||(t[4]=d=>c(p)({path:"/expenses",query:{branchId:u.value.branch_id}})),class:"px-4 my-2 lossBg"})])])]),n.value-i.value>0?(_(),v("div",De,[Se,e("h3",Ae,"ج.م "+m((n.value-i.value).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),1)])):(_(),v("div",Re,[Te,e("h2",je,"ج.م "+m((i.value-n.value).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),1)])),e("div",Ne,[l(c(Q),{type:"bar",data:k.value,options:T.value},null,8,["data","options"])])])):W("",!0)])}}});export{Oe as default};

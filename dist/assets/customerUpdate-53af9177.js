import{d as ae,u as se,r as o,o as le,k as oe,l as ie,C as ne,a as c,c as d,b as s,w as p,e as r,g as e,m as N,f as v,t as u,F as ce,h as m,s as w,v as H,E as re}from"./index-54b3e273.js";import{s as de}from"./successMsg-2def3ef6.js";import"./inputswitch.esm-f7379264.js";import{s as ue}from"./selectbutton.esm-6c460a53.js";/* empty css                                                   */const me={class:"flex align-items-center justify-content-center"},pe={class:"flex align-items-center mx-5 justify-content-center flex-column"},ve=e("div",{class:"flex align-items-center my-2"},[e("span",{class:"material-symbols-outlined mx-1 text-2xl"}," tag "),e("h4",null,"الكود")],-1),he={class:"flex align-items-center mx-5 justify-content-center flex-column"},_e=e("div",{class:"flex align-items-center my-2"},[e("h4",null,"الاسم"),e("span",{class:"material-symbols-outlined text-2xl"}," scuba_diving ")],-1),fe={class:"flex align-items-center mx-5 justify-content-center flex-column"},xe=e("div",{class:"flex align-items-center my-2"},[e("span",{class:"material-symbols-outlined mx-1 text-2xl"}," call "),e("h4",null,"رقم الهاتف")],-1),be={key:0,class:"flex align-items-center justify-content-center"},ge={class:"flex align-items-center mx-5 justify-content-center flex-column"},ye=e("div",{class:"flex align-items-center my-2"},[e("span",{class:"material-symbols-outlined mx-1 text-2xl"}," tag "),e("h4",null,"الكود")],-1),we={class:"flex align-items-center mx-5 justify-content-center flex-column"},ke=e("div",{class:"flex align-items-center my-2"},[e("h4",null,"تاريخ بداية الاشتراك"),e("span",{class:"material-symbols-outlined text-2xl"}," calendar_month ")],-1),Se={class:"flex align-items-center mx-5 justify-content-center flex-column"},Ce=e("div",{class:"flex align-items-center my-2"},[e("span",{class:"material-symbols-outlined mx-1 text-2xl"}," calendar_month "),e("h4",null,"تاريخ انتهاء الاشتراك")],-1),Ve={class:"flex justify-content-center mt-5 pt-5 m-auto",style:{direction:"rtl"}},qe={key:0,class:"w-12 md:w-10 m-auto p-2 md:p-5 customers"},De={class:"w-8 m-auto"},je={key:1,class:"px-3 py-2 textColor text-center borderRound error"},Te={key:0},$e=e("h1",{class:"p-4 text-center textColor"},"بيانات اللاعب",-1),Be={class:"flex grid w-full"},Ue={class:"mt-3 col-12"},Ee=e("div",{class:"flex align-items-center"},[e("label",{for:"name",class:"px-3 py-1 text-white text-sm"},"اسم المشترك")],-1),Ie={class:"mt-3 col-12 md:col-6"},Oe=e("div",{class:"flex align-items-center"},[e("label",{for:"mail",class:"px-3 py-1 text-white text-sm"},"البريد الالكتروني")],-1),Pe={class:"mt-3 col-12 md:col-6"},Fe=e("div",{class:"flex align-items-center"},[e("label",{for:"phone",class:"px-3 py-1 text-white text-sm"},"رقم الهاتف")],-1),ze={class:"col-12 md:col-6"},Ae=e("div",{class:"flex align-items-center"},[e("label",{for:"birthdate",class:"px-3 py-1 text-white text-sm"},"تاريخ الميلاد")],-1),Re={class:"col-12 md:col-6"},Le=e("div",{class:"flex align-items-center"},[e("label",{for:"job",class:"px-3 py-1 text-white text-sm"},"الوظيفة")],-1),Me={class:"col-12"},Ne=e("div",{class:"flex align-items-center"},[e("label",{for:"address",class:"px-3 py-1 text-white text-sm"},"عنوان المشترك")],-1),He={class:"col-12"},Ke=e("div",{class:"flex align-items-center"},[e("label",{for:"gender",class:"px-3 py-1 text-white text-sm"},"الجنس")],-1),We={key:1,class:"subscription w-full m-auto p-2 md:p-4 customers"},Ge=e("h1",{class:"p-4 text-center textColor"},"بيانات الاشتراك",-1),Je={class:"flex grid w-full"},Qe={class:"mt-3 col-12"},Xe=e("div",{class:"flex align-items-center"},[e("label",{for:"name",class:"px-3 py-1 text-white text-sm"},"الفرع")],-1),Ye={class:"flex grid w-full fadein animation-duration-300 animation-iteration-1"},Ze={class:"mt-3 col-12 md:col-6"},et=e("div",{class:"flex align-items-center"},[e("label",{for:"name",class:"px-3 py-1 text-white text-sm"},"المدرب")],-1),tt={class:"mt-3 col-12 md:col-6"},at=e("div",{class:"flex align-items-center"},[e("label",{for:"name",class:"px-3 py-1 text-white text-sm"},"نوع التمرين")],-1),st={class:"col-12 md:col-6"},lt=e("div",{class:"flex align-items-center"},[e("label",{for:"subscription_date",class:"px-3 py-1 text-white text-sm"},"تاريخ بداية الاشتراك")],-1),ot={class:"col-12 md:col-6"},it=e("div",{class:"flex align-items-center"},[e("label",{for:"expiration_date",class:"px-3 py-1 text-white text-sm"},"تاريخ انتهاء الاشتراك")],-1),nt={class:"mt-3 col-12 md:col-6"},ct=e("div",{class:"flex align-items-center"},[e("label",{for:"academy",class:"px-3 py-1 text-white text-sm"},"الأكاديمية")],-1),rt={class:"mt-3 col-12 md:col-6"},dt=e("div",{class:"flex align-items-center"},[e("label",{for:"avail_freeze_days",class:"px-3 py-1 text-white text-sm"},"الأيام المتاحة للتجميد")],-1),ut={class:"mt-3 col-12 md:col-6"},mt=e("div",{class:"flex align-items-center"},[e("label",{for:"number_of_sessions",class:"px-3 py-1 text-white text-sm"},"عدد الحصص في الاشتراك")],-1),pt={class:"mt-3 col-12 md:col-6"},vt=e("div",{class:"flex align-items-center"},[e("label",{for:"sessions_per_week",class:"px-3 py-1 text-white text-sm"},"عدد الحصص في الاسبوع")],-1),ht={class:"w-full m-auto repeater"},_t={class:"flex grid w-full align-items-center"},ft=e("div",{class:"flex align-items-center"},[e("label",{for:"price",class:"px-3 py-1 text-white text-sm"},"السعر")],-1),xt={key:0,class:"fadein animation-duration-500 animation-iteration-1 text-center p-3 borderRound",style:{color:"#256029","background-color":"#c8e6c9d3"}},bt={key:0,class:"col-12 md:col-6 fadein animation-duration-500 animation-iteration-1"},gt=e("div",{class:"flex align-items-center"},[e("label",{for:"sessions_per_week",class:"px-3 py-1 text-white text-sm"},"الخصم ( اختياري )")],-1),yt={class:"col-12 m-auto flex justify-content-center"},Dt=ae({__name:"customerUpdate",setup(wt){const{push:T,currentRoute:h}=se(),_=parseInt(h.value.params.id),O=o([]),K=o(),$=o([]),B=o([]),P=o([]),f=o(!1),x=o(),W=o(!1),G=o(),b=o(!1),k=o(!1),S=o(!1);o(!1);const C=o(!1);o();const J=o(!1),V=o(),i=o(),U=o(!1),g=o(),q=o(!1),E=o(),D=o(!1),j=o(!1),F=o(!0),Q=o(["تعديل اللاعب","تعديل الاشتراك"]),y=o("تعديل اللاعب"),X=a=>{q.value=!0,console.log(a),a.birthdate=new Date(a.birthdate),a.birthdate=a.birthdate.toISOString().substr(0,19).replace("T"," "),m.put(`http://127.0.0.1:8000/api/updateCustomer/${_}`,a).then(t=>{E.value=t.data.customer,q.value=!1,b.value=!1,f.value=!0,window.scrollTo({top:0,behavior:"smooth"}),D.value=!0,setTimeout(()=>{f.value=!1},1600)}).catch(t=>{window.scrollTo({top:0,behavior:"smooth"}),q.value=!1,b.value=!0,t.response.data.message.includes("The phone has already been taken")?g.value="هذا الهاتف موجود بالفعل":t.response.data.message.includes("The email has already been taken")?g.value="هذا البريد الالكتروني موجود بالفعل":g.value=t.response.data.message,console.log(t)})},z=()=>{m.get("http://127.0.0.1:8000/api/branches").then(a=>{console.log(a.data),K.value=a.data.branches,a.data.branches.forEach(t=>{O.value.push({label:t.branch_name,value:t.id})}),J.value=!0}).catch(a=>{console.log(a)})},I=()=>new Promise(a=>{m.get(`http://127.0.0.1:8000/api/coachesOfBranch/${i.value.branch_id}`).then(t=>{console.log(t.data),$.value=[],t.data.coaches.forEach(l=>{$.value.push({label:`كابتن / ${l.name}`,value:l.id})}),a($.value)})}),Y=()=>new Promise(a=>{m.get(`http://127.0.0.1:8000/api/categoriesOfBranch/${i.value.branch_id}`).then(t=>{console.log(t.data),B.value=[],t.data.categories.forEach(l=>{B.value.push({label:l.category_name,value:l.id})}),a(B.value)})}),A=()=>{m.get(`http://127.0.0.1:8000/api/customer/${_}`).then(a=>{console.log(a.data),V.value=a.data.customer,i.value=a.data.lastSubscription,I(),U.value=!0}).catch(a=>{console.log(a)})},R=()=>{m.get(`http://127.0.0.1:8000/api/customer/private/${_}`).then(a=>{console.log(a.data),V.value=a.data.customer,i.value=a.data.lastSubscription,I(),U.value=!0}).catch(a=>{console.log(a)})},Z=()=>{S.value=!0,i.value.subscription_date=new Date(i.value.subscription_date),i.value.subscription_date=i.value.subscription_date.toISOString().substr(0,19).replace("T"," "),i.value.expiration_date=new Date(i.value.expiration_date),i.value.expiration_date=i.value.expiration_date.toISOString().substr(0,19).replace("T"," "),i.value.customer_id=_;let a=[];i.value.training_schedules.forEach(t=>{a.push(t.id)}),i.value.is_private=j.value,i.value.schedulesIds=a,console.log(i.value),m.put(`http://127.0.0.1:8000/api/updateSubscription/${i.value.id}`,i.value).then(t=>{x.value=t.data.subscription,S.value=!1,b.value=!1,f.value=!0,window.scrollTo({top:0,behavior:"smooth"}),k.value=!0,console.log(x.value),setTimeout(()=>{f.value=!1},1600)}).catch(t=>{window.scrollTo({top:0,behavior:"smooth"}),S.value=!1,b.value=!0,g.value=t.response.data.message,console.log(t)})},L=()=>{j.value?T("/privateSubscriptions"):T("/customers")},M=()=>{m.get("http://127.0.0.1:8000/api/academies").then(a=>{console.log(a.data),a.data.academies.forEach(t=>{P.value.push({label:t.academy_name,value:t.id})})}).catch(a=>{console.log(a)})},ee=o(),te=o("admin");return le(()=>{oe().then(a=>{a==!1?ie().then(t=>{t==!1&&(localStorage.removeItem("SwimmingToken"),location.reload(),T({path:"/login",query:h.value.query})),ee.value=t.permissions,te.value="employee",F.value=!0,h.value.query.updateSubscription=="true"&&(y.value="تعديل الاشتراك"),h.value.query.isPrivate=="true"?(j.value=!0,R()):A(),z(),M()}):(F.value=!0,h.value.query.updateSubscription=="true"&&(y.value="تعديل الاشتراك"),h.value.query.isPrivate=="true"?(j.value=!0,R()):A(),z(),M())})}),(a,t)=>{const l=ne("FormKit");return c(),d(ce,null,[s(r(H),{visible:D.value,"onUpdate:visible":t[1]||(t[1]=n=>D.value=n),onAfterHide:L,modal:"",header:"بيانات الاشتراك",style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"}},{footer:p(()=>[s(r(w),{label:"تم",class:"px-4 py-1",onClick:t[0]||(t[0]=n=>D.value=!1),autofocus:""})]),default:p(()=>[e("div",me,[e("div",pe,[ve,e("p",null,u(r(_)),1)]),e("div",he,[_e,e("p",null,u(E.value.customer_name),1)]),e("div",fe,[xe,e("p",null,u(E.value.customer_phone),1)])])]),_:1},8,["visible"]),s(r(H),{visible:k.value,"onUpdate:visible":t[3]||(t[3]=n=>k.value=n),onAfterHide:L,modal:"",header:"بيانات الاشتراك",style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"}},{footer:p(()=>[s(r(w),{label:"تم",class:"px-4 py-1",onClick:t[2]||(t[2]=n=>k.value=!1),autofocus:""})]),default:p(()=>[x.value?(c(),d("div",be,[e("div",ge,[ye,e("p",null,u(r(_)),1)]),e("div",we,[ke,e("p",null,u(new Date(x.value.subscription_date).toLocaleDateString()),1)]),e("div",Se,[Ce,e("p",null,u(new Date(x.value.expiration_date).toLocaleDateString()),1)])])):v("",!0)]),_:1},8,["visible"]),e("div",Ve,[s(r(ue),{modelValue:y.value,"onUpdate:modelValue":t[4]||(t[4]=n=>y.value=n),options:Q.value,"aria-labelledby":"basic"},null,8,["modelValue","options"])]),U.value?(c(),d("div",qe,[e("div",De,[f.value?(c(),N(de,{key:0,class:"fadeinright animation-duration-1000 animation-iteration-1"})):v("",!0),b.value?(c(),d("h5",je,u(g.value),1)):v("",!0)]),y.value=="تعديل اللاعب"?(c(),d("div",Te,[$e,s(l,{type:"form",modelValue:V.value,"onUpdate:modelValue":t[5]||(t[5]=n=>V.value=n),actions:!1,onSubmit:X},{default:p(()=>[e("div",Be,[e("div",Ue,[Ee,s(l,{"prefix-icon":"avatarMan",id:"name",type:"text",label:"اسم المشترك",placeholder:"أدخل اسم المشترك",name:"customer_name",validation:"required|length:2"})]),e("div",Ie,[Oe,s(l,{"prefix-icon":"email",id:"mail",type:"email",label:"البريد الالكتروني",placeholder:"أدخل البريد الالكتروني",name:"customer_email",validation:"required|email"})]),e("div",Pe,[Fe,s(l,{"prefix-icon":"telephone",id:"phone",type:"text",label:"رقم الهاتف",placeholder:"أدخل رقم هاتف المشترك",name:"customer_phone",validation:"required|length:10"})]),e("div",ze,[Ae,s(l,{type:"datepicker",name:"birthdate",label:"تاريخ الميلاد",id:"birthdate",format:{date:"short"}})]),e("div",Re,[Le,s(l,{"prefix-icon":"text",id:"job",type:"text",label:"الوظيفة",placeholder:"أدخل وظيفة المشترك ",name:"job",validation:"required"})]),e("div",Me,[Ne,s(l,{"prefix-icon":"text",id:"address",type:"textarea",label:"العنوان",placeholder:"أدخل عنوان للمشترك ",name:"customer_address",validation:"required|length:3"})]),e("div",He,[Ke,s(l,{id:"gender",type:"dropdown",options:[{label:"ذكر",value:"male"},{label:"أنثي",value:"female"}],label:"الجنس",placeholder:"أختر جنس المشترك ",name:"gender",validation:"required"})])]),s(r(w),{type:"submit",class:"submitBtn",label:"حفظ",loading:q.value},null,8,["loading"])]),_:1},8,["modelValue"])])):(c(),d("div",We,[Ge,s(l,{type:"form",modelValue:i.value,"onUpdate:modelValue":t[7]||(t[7]=n=>i.value=n),actions:!1,onSubmit:Z},{default:p(()=>[e("div",Je,[e("div",Qe,[Xe,s(l,{type:"dropdown",name:"branch_id",label:"الفرع",placeholder:"اختر الفرع الذي سيحضر فيه المشترك",options:O.value},null,8,["options"])]),e("div",Ye,[e("div",Ze,[et,s(l,{type:"dropdown",name:"coach_id","always-load-on-open":"true","empty-message":"لا يوجد مدربين لهذا الفرع",label:"المدرب",placeholder:"اختر المدرب الذي سيحضر معه المشترك",options:I})]),e("div",tt,[at,s(l,{type:"dropdown",name:"category_id",label:"نوع التمرين","empty-message":"لا يوجد تمارين في هذا الفرع",placeholder:"اختر نوع التمرين",options:Y})]),e("div",st,[lt,s(l,{type:"datepicker",name:"subscription_date",label:"تاريخ الاشتراك",id:"subscription_date",format:{date:"short"},validation:"required",value:new Date},null,8,["value"])]),e("div",ot,[it,s(l,{type:"datepicker",name:"expiration_date",label:"تاريخ الانتهاء",id:"expiration_date","min-date":new Date,validation:"required",format:{date:"short"}},null,8,["min-date"])]),e("div",nt,[ct,s(l,{type:"dropdown",id:"academy",name:"academy_id",label:"الأكاديمية",placeholder:"اختر الأكاديمية",options:P.value,validation:"required"},null,8,["options"])]),e("div",rt,[dt,s(l,{"prefix-icon":"number",number:"integer",id:"avail_freeze_days",type:"number",label:"أيام التجميد",placeholder:"أدخل الأيام المتاحة لتجميد الاشتراك",name:"avail_freeze_days",validation:"required|min:0"})]),e("div",ut,[mt,s(l,{"prefix-icon":"number",number:"integer",id:"number_of_sessions",type:"number",label:"عدد الحصص",placeholder:"أدخل عدد حصص الاشتراك ",name:"number_of_sessions",validation:"required|min:1"})]),e("div",pt,[vt,s(l,{"prefix-icon":"number",number:"integer",id:"sessions_per_week",type:"number",label:"عدد الحصص الاسبوعية",placeholder:"أدخل عدد الحصص في الاسبوع ",name:"sessions_per_week",validation:"required|min:1"})]),e("div",ht,[s(l,{id:"repeater",name:"training_schedules",type:"repeater","add-label":"اضافة موعد",label:"جدول المواعيد"},{default:p(({index:n})=>[e("div",_t,[s(l,{type:"dropdown","outer-class":"col-12 md:col-6",name:"day",label:`${n+1}. اليوم`,placeholder:"اختر اليوم",options:["السبت","الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة"],validation:"required"},null,8,["label"]),s(l,{type:"time",label:"موعد بدء التمرين","outer-class":"col-12 md:col-6",name:"time",value:"21:00",validation:"required"})])]),_:1})]),e("div",{class:re(["col-12",{"md:col-6":C.value}])},[ft,s(l,{"prefix-icon":"dollar",id:"price",type:"number",label:"سعر الاشتراك",placeholder:"أدخل سعر الاشتراك",name:"price",number:"float",validation:"required|min:1"}),W.value?(c(),d("h5",xt,"السعر المسجل لهذا العدد من الحصص هو "+u(G.value)+" ج.م",1)):v("",!0)],2),C.value?(c(),d("div",bt,[gt,s(l,{"prefix-icon":"dollar",id:"sessions_per_week",type:"number",label:"الخصم",placeholder:"أدخل مبلغ الخصم بالجنية ",number:"float",name:"sale",validation:"min:0"})])):v("",!0),e("div",yt,[C.value?v("",!0):(c(),N(r(w),{key:0,type:"button",class:"",style:{background:"var(--background)"},label:"أدخل مبلغ خصم",onClick:t[6]||(t[6]=n=>C.value=!0)}))])])]),s(r(w),{type:"submit",class:"submitBtn my-5",label:"تعديل الاشتراك",loading:S.value},null,8,["loading"])]),_:1},8,["modelValue"])]))])):v("",!0)],64)}}});export{Dt as default};
